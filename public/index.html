<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Live Score</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            background-color: #f5f5f5;
        }
        
        .match-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .toss-info {
            font-size: 14px;
            color: #555;
            margin-bottom: 20px;
        }
        
        .live-score-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            color: #e74c3c;
            margin: 25px 0 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .score-box {
            background: linear-gradient(135deg, #ffffff, #f9f9f9);
            border-radius: 10px;
            padding: 20px;
            margin: 0 auto;
            width: 70%;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }
        
        .batting-team {
            font-size: 22px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .score {
            font-size: 36px;
            font-weight: bold;
            color: #e74c3c;
            margin: 5px 0;
        }
        
        .overs {
            font-size: 18px;
            color: #7f8c8d;
        }
        
        .this-over {
            margin-top: 15px;
            font-size: 16px;
        }
        .this-over span {
            display: inline-block;
            margin: 0 3px;
            font-weight: bold;
        }
        
        .last-updated {
            margin-top: 25px;
            font-size: 12px;
            color: #95a5a6;
            font-style: italic;
        }
        
        .refresh-btn {
            padding: 10px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 25px;
            transition: background-color 0.3s;
        }
        
        .refresh-btn:hover {
            background-color: #2980b9;
        }
        
        .vs {
            color: #e74c3c;
            font-weight: bold;
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <div class="match-title">
        <span id="team1-name">Team 1</span> 
        <span class="vs">VS</span> 
        <span id="team2-name">Team 2</span>
    </div>
    
    <div class="toss-info" id="toss-info">
        Toss Winner: Loading... | chose to bat
    </div>
    
    <div class="live-score-title">Live Score</div>
    
    <div class="score-box">
        <div class="batting-team" id="current-batting-team">Loading...</div>
        <div class="score" id="current-score">0 - 0</div>
        <div class="overs" id="current-overs">0.0/0 overs</div>
        <div class="this-over">
            This over: <span id="this-over-display"></span>
        </div>
    </div>
    
    <div class="last-updated" id="last-updated">Last updated: Just now</div>
    <button class="refresh-btn" onclick="fetchScore()">Refresh</button>

    <script>
        function formatTime(date) {
            const now = new Date();
            const diff = Math.floor((now - date) / 1000); // difference in seconds
            
            if (diff < 10) return 'Just now';
            if (diff < 60) return `${diff} seconds ago`;
            if (diff < 3600) return `${Math.floor(diff/60)} minutes ago`;
            return date.toLocaleTimeString();
        }

        function fetchScore() {
            fetch('/api/score')
                .then(response => response.json())
                .then(data => {
                    if (data.team1) {
                        // Update match title
                        document.getElementById('team1-name').textContent = data.team1;
                        document.getElementById('team2-name').textContent = data.team2;
                        
                        // Update toss information
                        const tossWinner = data.toss_winner === 'team1' ? data.team1 : data.team2;
                        const tossDecision = data.toss_decision === 'bat' ? 'chose to bat' : 'chose to bowl';
                        document.getElementById('toss-info').textContent = 
                            `Toss Winner: ${tossWinner} | ${tossDecision}`;
                        
                        // Update current batting team and score
                        const battingTeam = data.current_batting == 1 ? data.team1 : data.team2;
                        document.getElementById('current-batting-team').textContent = battingTeam;
                        document.getElementById('current-score').textContent = 
                            `${data.current_runs} - ${data.current_wickets}`;
                        document.getElementById('current-overs').textContent = 
                            `${data.current_overs.toFixed(1)}/${data.total_overs} overs`;
                        
                        // Update this over display
                        const thisOver = data.this_over ? data.this_over.split(',') : [];
                        document.getElementById('this-over-display').innerHTML = 
                            thisOver.map(ball => `<span>${ball}</span>`).join(' ');
                        
                        // Update timestamp
                        if (data.last_updated) {
                            const date = new Date(data.last_updated);
                            document.getElementById('last-updated').textContent = 
                                `Last updated: ${formatTime(date)}`;
                        }
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        // Fetch score every 5 seconds
        setInterval(fetchScore, 5000);
        fetchScore(); // Initial load
    </script>
</body>
</html>